!function(t){"use strict";function e(t,e,n){var i="",o="";if(n){var r=new Date;r.setTime(r.getTime()+60*n*1e3),i="; expires="+r.toGMTString()}m.domain&&(o="; domain="+m.domain),document.cookie=t+"="+escape(e)+i+o+"; path=/"}function n(t){var e,n,i=t+"=",o=document.cookie.split(";");for(e=0;e<o.length;e++){for(n=o[e];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(i))return unescape(n.substring(i.length,n.length))}return null}function i(t){e(t,"",-1)}function o(e){n("ahoy_debug")&&t.console.log(e)}function r(){for(var t;t=x.shift();)t();b=!0}function s(t){b?t():x.push(t)}function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})}function l(){w&&e("ahoy_events",JSON.stringify(T),1)}function u(t){s(function(){w&&g.ajax({type:"POST",url:E,data:JSON.stringify([t]),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){for(var e=0;e<T.length;e++)if(T[e].id==t.id){T.splice(e,1);break}l()}})})}function c(){return m.page||t.location.pathname}function d(t){var e=g(t.currentTarget);return{tag:e.get(0).tagName.toLowerCase(),id:e.attr("id"),"class":e.attr("class"),page:c(),section:e.closest("*[data-section]").data("section")}}var p,f,h,m=t.ahoy||t.Ahoy||{},g=t.jQuery||t.Zepto||t.$,v=240,y=1051200,b=!1,x=[],w="undefined"!=typeof JSON&&"undefined"!=typeof JSON.stringify,T=[],C=m.visitsUrl||"/ahoy/visits",E=m.eventsUrl||"/ahoy/events";if(p=n("ahoy_visit"),f=n("ahoy_visitor"),h=n("ahoy_track"),p&&f&&!h)o("Active visit"),r();else if(h&&i("ahoy_track"),p||(p=a(),e("ahoy_visit",p,v)),n("ahoy_visit")){o("Visit started"),f||(f=a(),e("ahoy_visitor",f,y));var k={visit_token:p,visitor_token:f,platform:m.platform||"Web",landing_page:t.location.href,screen_width:t.screen.width,screen_height:t.screen.height};document.referrer.length>0&&(k.referrer=document.referrer),o(k),g.post(C,k,r,"json")}else o("Cookies disabled"),r();m.getVisitId=m.getVisitToken=function(){return p},m.getVisitorId=m.getVisitorToken=function(){return f},m.reset=function(){return i("ahoy_visit"),i("ahoy_visitor"),i("ahoy_events"),i("ahoy_track"),!0},m.debug=function(t){return t===!1?i("ahoy_debug"):e("ahoy_debug","t",525600),!0},m.track=function(t,e){var n={id:a(),name:t,properties:e,time:(new Date).getTime()/1e3};o(n),T.push(n),l(),setTimeout(function(){u(n)},1e3)},m.trackView=function(){var e={url:t.location.href,title:document.title,page:c()};m.track("$view",e)},m.trackClicks=function(){g(document).on("click","a, button, input[type=submit]",function(t){var e=g(t.currentTarget),n=d(t);n.text="input"==n.tag?e.val():g.trim(e.text().replace(/[\s\r\n]+/g," ")),n.href=e.attr("href"),m.track("$click",n)})},m.trackSubmits=function(){g(document).on("submit","form",function(t){var e=d(t);m.track("$submit",e)})},m.trackChanges=function(){g(document).on("change","input, textarea, select",function(t){var e=d(t);m.track("$change",e)})},m.trackAll=function(){m.trackView(),m.trackClicks(),m.trackSubmits(),m.trackChanges()};try{T=JSON.parse(n("ahoy_events")||"[]")}catch(S){}for(var N=0;N<T.length;N++)u(T[N]);t.ahoy=m}(window);